---
# - hosts: webblog-app-vm
#   become_user: root
#   become: true
#   tasks:
#     - name: Install pip3
#       apt:
#         name: python3-pip
#     - name: Install Docker module for Python
#       pip:
#         name: docker
#     - name: Pull the Jenkins Docker image
#       docker_image:
#         name: "samgabrail/jenkins-tf-vault-ansible:latest"
#         source: pull
#         state: present
#         force_source: yes
#     - name: Create Jenkins container
#       docker_container:
#         name: "jenkins"
#         image: "samgabrail/jenkins-tf-vault-ansible:latest"
#         state: started
#         ports:
#           - "8080:8080"
#           - "50000:50000"
#         volumes:
#           - jenkins_home:/var/jenkins_home

- hosts: webblog-db-vm
  become_user: root
  become: true
  tasks:
    - name: Install pip3
      apt:
        name: python3-pip
    - name: Install Docker module for Python
      pip:
        name: docker
    - name: Pull the Mongo Docker image
      docker_image:
        name: "mongo:4.2.7"
        source: pull
        state: present
        force_source: yes
    - name: Create Mongo container
      docker_container:
        name: "mongo"
        image: "mongo:4.2.7"
        state: started
        ports:
          - "27017:27017"
        env:
          MONGO_INITDB_ROOT_USERNAME: "{{ mongo_root_user }}"
          MONGO_INITDB_ROOT_PASSWORD: "{{ mongo_root_password }}"
        volumes:
          - mongo_data:/data/db
